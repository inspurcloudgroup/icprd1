[TOC]


# 12_linux启动流程

```
[设备加电] -> [bios自检] -> [引导启动] -> [装载内核] -> [系统初始化] -> [用户登陆]

1. bios自检没有硬件问题则会启动主引导记录 MBR (MasterBoot Recored，主引导分区)中的引导程序, 一般是grub
2. init进程, 内核启动启动后执行的第一个进程, 它是所有进程的父进程, 一直运行, id为1
```



## 运行级别

| 级别    | 功能                                                         |
| ------- | ------------------------------------------------------------ |
| 0       | 关闭系统                                                     |
| 1       | 让系统进入单用户（S，恢复）模式                              |
| 2/3/4/5 | 多用户模式，图形登陆界面，运行所有预定的系统服务。对于系统定制而言，运行级别2-5的作用相同 |
| 6       | 重启系统                                                     |
| S       | 单用户与（恢复）模式， 文本登录界面，只运行很少几项系统服务  |

> tips: 默认情况下，ubuntu 系统引导进入运行级别 2



## 添加移除自启程序

### 方式一

相关配置文件: /etc/rc.local 

如果需要添加执行的操作，那么必须写在 `exit 0` 之前

### 方式二

相关配置目录: /etc/init.d/

```shell
# 将自定义脚本添加至启动项
cd /etc/init.d
sudo update-rc.d test.sh defaults 95
# 95表示一个优先级, 越小越早执行
```

### 方式三

使用 sysv-rc-conf 工具



# 13_linux进程与工作

### 进程

子进程正常终止时会向父进程传递一个SIGCHLD信号， 父进程做最后的资源回收与收尾工作

有些特殊情况会产生特殊的进程：

- 僵尸进程 （zoombie）

  子进程代码执行完成，资源也已经回收， 但是父进程没有做最后的收尾工作，导致进程的进程控制块（PCB）仍然驻留在内存中

- 孤儿进程

  父进程非正常结束，未能及时回收子进程，子进程依然在运行

  孤儿进程一般会被init进程管理，成为init的子进程，由init来做善后处理

- 内核初始化进程

  进程0，内核初始化，其最后一个动作是创建一个init进程（进程1），然后进程0变为空闲进程

**按照功能分** : 用户进程，系统进程

**按照服务类型分**：交互进程，守护进程，批处理进程

### 工作管理

```shell
# 将前台工作停止并放入后台
ctrl+z
# 显示后台工作
jobs
# 将后台工作放到前台
fg
# 启动后台被停止的工作（ctrl+z）
bg

# 查看所有的信号
kill -l
# signal表示信号值
kill -signal [ pid | %job_id ]
```

| 信号值 | 作用                            |
| ------ | ------------------------------- |
| -1     | 重新读取参数运行，类似于restart |
| -2     | 如同 ctrl+c 的操作退出          |
| -9     | 强制终止该任务                  |
| -15    | 正常的方式终止该任务            |

### 进程状态

**top**

load average: 等待cpu的平均进程数， 单cpu单核以load=1为重要界限， 一般将临界值设为0.7

常用命令：

`P`：根据cpu使用率排序

`M`：根据内存使用率排序

`i`：忽略闲置和僵死进程

`k`：终止一个进程， 一般用15信号，不能正常结束使用9信号强制终止



**ps**

```shell
# 最常用的命令，罗列所有进程信息
ps aux
```



# 14_linux帮助命令

内建命令： history，cd，exit等，驻留在内存，不需要创建子进程，执行速度快 

外部命令

> tips:
>
> 1. 使用type命令可以区分命令的类型
> 2. help +命令 只对内建命令有效

alias命令，给命令起别名

```shell
# .bashrc
alias rm='rm -i'
```



## man命令

| 章节数 | 说明                                               |
| :---: | -------------------------------------------------- |
| `1`    | Standard commands （标准命令）                     |
| `2`    | System calls （系统调用）                          |
| `3`    | Library functions （库函数）                       |
| `4`    | Special devices （设备说明）                       |
| `5`    | File formats （文件格式）                          |
| `6`    | Games and toys （游戏和娱乐）                      |
| `7`    | Miscellaneous （杂项）                             |
| `8`    | Administrative Commands （管理员命令）             |
| `9`    | 其他（Linux特定的）， 用来存放内核例行程序的文档 |

## info命令（了解）

比man命令信息更多



[下一篇: linux基础(15)](./陈玉林_20190526.md)

