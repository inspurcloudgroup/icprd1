linux基础教程(7)

# linux管道符
linux内核I/O库sdtio提供了一个高效的缓存I/O流接口, 每一个程序在启动时都会有三个stream:
- stdin 标准输入流
- stdout 标准输出流  
- stderr 标准错误流

### 文件描述符
1. kernel通过文件描述符(file descriptor)来访问文件
2. 文件描述符是非负整数, 打开或新建文件, 内核都会返回一个文件描述符, 读写文件都需要通过文件描述符指定.
3. 内核为每个进程维护一个打开文件记录表, 程序打开或者新建文件时, 内核向进程返回一个文件描述符.

### stdin
与stdin关联的整数文件描述符为0

### stdout
与stdout关联的整数文件描述符为1

### stderr
与stderr关联的整数文件描述符为2

## 管道
用于程序之间的通信.
shell中使用`|`表示管道, 有时会使用`|&`表示.

`command1 | command2`: command1的**标准输出**作为command2的**标准输入**

## 重定向
重定向输入的一般格式:
```shell
n < file
# 将输入重定向到file
# n表示文件描述符, 不指定n值时, 默认是0(标准输入)
```

重定向输出的一般格式:
```shell
n > file
# 将输出重定向到file
# n表示文件描述符, 不指定n值时, 默认为1(标准输出)
# 注意点: 1.如果file不存在, 则会创建file
#         2.如果file存在, 文件大小将被设为0
          3.如果需要附加内容到文件, 使用 >>
# eg:
# 将test1的内容作为标准输入, 重定向到test2
cat > test2 < test1
# 等效于:
cat test1 | cat > test2
```

重定向stdout和stderr:
```shell
# 将command1的标准输出和*标准错误*作为command2的标准输入
command1 |& command2

# 重定向也是类似的(了解即可)
&> file
&>> file

# 更常用的使用方式是将标准输出和标准错误分开重定向
command  2>err.log 1>info.log
```

### tee
读取标准输入, 并将其写入标准输入和文件中.

### 文本处理
1. 排序 sort
sort将文本内容**以行为单位**进行排序
- `-u` 去除重复行
- `-t` 指定分割符, 默认为空格
- `-o` 输出到指定文件
- `-k` 指定使用某一列进行排序
- `-r` 改为降序排序, 默认是升序

2. 合并
paste, join(了解即可)

3. tr
转换或者删除(了解即可)

4. xargs
xargs从标准输入构建和执行命令, 没有指定命令时默认将数据传给echo, 默认分割符号为空格
常见的参数:
- `-a` 指定从文件读取, 而不是标准输入
- `-d` 自定义分隔符
- `-n` 每行最多参数个数

```shell
# 示例: 删除mysql相关文件
find / -name mysql | xargs rm -rf
```

[下一篇: linux基础(7-8)](./陈玉林_20190523.md)